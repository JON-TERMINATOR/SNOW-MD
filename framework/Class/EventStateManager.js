const a64_0x2a1369=a64_0x3e2d;(function(_0x4e206d,_0x29179d){const _0x4339ca=a64_0x3e2d,_0x510270=_0x4e206d();while(!![]){try{const _0xb4bfe2=-parseInt(_0x4339ca(0x1d4))/0x1*(-parseInt(_0x4339ca(0x1e5))/0x2)+parseInt(_0x4339ca(0x1d6))/0x3*(-parseInt(_0x4339ca(0x1e8))/0x4)+-parseInt(_0x4339ca(0x1d0))/0x5+parseInt(_0x4339ca(0x1bf))/0x6+parseInt(_0x4339ca(0x1c7))/0x7+-parseInt(_0x4339ca(0x1f8))/0x8+-parseInt(_0x4339ca(0x1e6))/0x9*(-parseInt(_0x4339ca(0x1d8))/0xa);if(_0xb4bfe2===_0x29179d)break;else _0x510270['push'](_0x510270['shift']());}catch(_0x38dff2){_0x510270['push'](_0x510270['shift']());}}}(a64_0x1e90,0x79b09));function a64_0x1e90(){const _0x153e03=['Aw5JBhvKzxm','ugvVEve','q2v0DguGy29TBwfUzguGzxn0ihjLC2vYDMvYihvUAxf1zw1LBNqGCg91CIbSzxmGz3jVDxbLCW','wMzty1O','z2v0qwn0Aw9UrM9YsMLK','yxbWBhK','zw5HyMXLza','C2vXDwvSAxPL','t1v0v1C','zxrHDa','DMfSDwvZ','ihDPDgGGywn0Aw9Uia','wgvnD1y','lI4VEM9RB3u','igzVCIbQAwqG','mtG5nJq3mNLJs0jdsG','ze9JDuW','u1rbvevt','DhjPBq','qunusu9ouW','DNbJzK0','AM9YDuK','zgLZywjSzwq','kIdINQhVUi8Gx0fJDgLVBIa6xYdWN5Er77IpifjLDgLYzxik4OcIicO','D2fYBG','z2v0','u0XbqKS','mZqYnJy0mNzVyNnfta','Dg9tDhjPBMC','kcGOlISPkYKRksSK','zgvMAw5L','zgvSzxrL','C3rHCNrZv2L0Aa','igvZDcbKzwPHigfJDgLM','igfJDgLVBI8','mZi5otC2nvDABNvjCW','x2LUAxq','tcDHy3rPB24GzguG','kIdINQhVUi8Gx0fJDgLVBIa6xYdIMQdVUi8Gu3vWChjPBwvYcUkaOIaQ','uK1Mqvy','C2X1ANG','vM1urMi','C2vHCMnO','rxjYB3iGy2HLy2TPBMCGzw5HyMXLzcbZDgf0zsbMB3iGAMLKia','ndCWmtK3mhfSyLH1uG','kIdINQhVUi8Gx3bVDxiGBgeGzmoPC2fJDgL2zxjFiokDJaOk4PQz77IpicPdAgfUz2vYigWNywn0Aw9UkIa6cUkaOIaQ','twr5r3C','rxjYB3iGC2v0DgLUzYa','mxPYt2jdBq','CMv0AxjLCG','nLDtDLzfrW','rxjYB3iGz2v0DgLUzYbHy3rPB24GzM9YigPPzca','ndaZndCWmgjHzhHsqW','DxbZzxj0','vw5LigvYCMv1CIbLC3qGC3vYDMvUDwuGlcb2zwLSBgv6ig5VDxmGzw4GAw5MB3jTzxOGC3vYigXLigzVCNvTihnPihbLCMnPC3rHBNq','u1rssu5h','y29UC3rYDwn0B3i','ywn0Aw9U','zw5HyMXLzezVCKPPza','ENrLuvi','zxjYB3i','C3vWCa','vMzsuMG','C2v0','tNDOAgC','mtG4nJeYohfoA21dEG','oxbIAu95vW','igvZDcbKzwPHigrLC2fJDgL2zq','mtqYnJi4ng9HtLnHEG'];a64_0x1e90=function(){return _0x153e03;};return a64_0x1e90();}const a64_0x186d7b=(function(){const _0x220cf0=a64_0x3e2d,_0x5f5989={'OUtWW':function(_0x4de8fb,_0x1c67ef){return _0x4de8fb!==_0x1c67ef;},'Nwhhg':_0x220cf0(0x1fd)};let _0x2c6827=!![];return function(_0x466e10,_0x54f0a2){const _0x161614=_0x220cf0,_0x35c38a={'VmTFb':function(_0x1ea13f,_0x1db6fd){const _0x152ab4=a64_0x3e2d;return _0x5f5989[_0x152ab4(0x1f1)](_0x1ea13f,_0x1db6fd);},'kTKak':_0x5f5989[_0x161614(0x1e4)]},_0x52a4ce=_0x2c6827?function(){const _0x47701e=_0x161614;if(_0x54f0a2){if(_0x35c38a[_0x47701e(0x1cd)](_0x35c38a['kTKak'],_0x47701e(0x1fd)))return _0xd13f7b[_0x47701e(0x1e0)]('Error\x20checking\x20enabled\x20state\x20for\x20jid\x20'+_0x54835d+':',_0x28961b),![];else{const _0x3a84eb=_0x54f0a2[_0x47701e(0x1ee)](_0x466e10,arguments);return _0x54f0a2=null,_0x3a84eb;}}}:function(){};return _0x2c6827=![],_0x52a4ce;};}()),a64_0x375cb9=a64_0x186d7b(this,function(){const _0x2a2f2a=a64_0x3e2d,_0x88fcb8={'aliCj':_0x2a2f2a(0x1c1)};return a64_0x375cb9[_0x2a2f2a(0x1c0)]()['search'](_0x88fcb8['aliCj'])[_0x2a2f2a(0x1c0)]()[_0x2a2f2a(0x1dc)](a64_0x375cb9)[_0x2a2f2a(0x1ce)]('(((.+)+)+)+$');});a64_0x375cb9();const NodeCache=require('node-cache'),{DB}=require('../../bdd/_index'),{zokou}=require(a64_0x2a1369(0x1f6)),{DataTypes,Model}=require(a64_0x2a1369(0x1f0));class EventStateManager{#tableName;#db=null;['_init']=null;[a64_0x2a1369(0x1fa)]={'enabled':'oui','disabled':'non'};[a64_0x2a1369(0x1fc)]={'remove':a64_0x2a1369(0x1d5),'delete':a64_0x2a1369(0x1e1),'warn':a64_0x2a1369(0x1bc)};#defaultAction=this['ACTIONS']['remove'];#defaultState=this[a64_0x2a1369(0x1fa)]['disabled'];#cache;constructor(_0x464d13,_0x30ab2f=new NodeCache()){const _0x10c03a=a64_0x2a1369;this.#tableName=_0x464d13,this.#cache=_0x30ab2f,this[_0x10c03a(0x1c8)]=this.#createTable();}async #createTable(){const _0x2e2c61=a64_0x2a1369;this.#db=DB[_0x2e2c61(0x1c2)](this.#tableName,{'jid':{'type':DataTypes[_0x2e2c61(0x1db)],'primaryKey':!![]},'etat':{'type':DataTypes[_0x2e2c61(0x1db)],'defaultValue':this.#defaultState},'action':{'type':DataTypes[_0x2e2c61(0x1db)],'defaultValue':this.#defaultAction}}),await this.#db['sync']();}async #addOrUpdateJid(_0x752edc,_0x2d15fd=this.#defaultState){const _0x19e4ad=a64_0x2a1369;await this[_0x19e4ad(0x1c8)],await this.#db[_0x19e4ad(0x1d9)]({'jid':_0x752edc,'etat':_0x2d15fd});const _0x9261d9=this.#cache['get'](_0x752edc)||{};this.#cache[_0x19e4ad(0x1e3)](_0x752edc,{..._0x9261d9,'etat':_0x2d15fd});}async #updateJidAction(_0x6b5c81,_0x237c97=this.#defaultAction){const _0x37dad7=a64_0x2a1369;try{await this['_init'],await this.#db[_0x37dad7(0x1d9)]({'jid':_0x6b5c81,'action':_0x237c97});const _0x1ffbdc=this.#cache[_0x37dad7(0x1bd)](_0x6b5c81)||{};this.#cache['set'](_0x6b5c81,{..._0x1ffbdc,'action':_0x237c97});}catch(_0x43e9cc){console['error']('Error\x20updating\x20jid\x20'+_0x6b5c81+_0x37dad7(0x1f4)+_0x237c97+':',_0x43e9cc);throw _0x43e9cc;}}async[a64_0x2a1369(0x1de)](_0x508a5d){const _0x1721e9=a64_0x2a1369,_0x233730={'dOcuL':function(_0x570101,_0xc35919){return _0x570101(_0xc35919);},'MdyGw':function(_0x58d8fb,_0x3195da){return _0x58d8fb===_0x3195da;},'RMfAV':_0x1721e9(0x1ea),'ZfScZ':function(_0x3eb32d,_0x57fd69){return _0x3eb32d!==_0x57fd69;},'IvesH':function(_0x54c1a1,_0x390773){return _0x54c1a1!==_0x390773;}};try{const _0x49fcae=this.#cache[_0x1721e9(0x1bd)](_0x508a5d);if(_0x49fcae?.[_0x1721e9(0x1f2)]!==undefined)return _0x233730[_0x1721e9(0x1d2)](_0x233730[_0x1721e9(0x1cb)],'HchaD')?_0x233730[_0x1721e9(0x1f9)](_0x4d9015,_0x1721e9(0x1eb)):_0x233730[_0x1721e9(0x1ec)](_0x49fcae[_0x1721e9(0x1f2)],this.#defaultState);await this[_0x1721e9(0x1c8)];const _0x206b47=await this.#db['findByPk'](_0x508a5d);if(_0x206b47){const _0x4f83e6=_0x206b47[_0x1721e9(0x1bd)]({'plain':!![]});return this.#cache[_0x1721e9(0x1e3)](_0x508a5d,{...this.#cache['get'](_0x508a5d)||{},'etat':_0x4f83e6[_0x1721e9(0x1f2)]}),_0x233730['IvesH'](_0x4f83e6[_0x1721e9(0x1f2)],this.#defaultState);}return![];}catch(_0x5c51e4){return console[_0x1721e9(0x1e0)](_0x1721e9(0x1cf)+_0x508a5d+':',_0x5c51e4),![];}}async[a64_0x2a1369(0x1ed)](_0x3c9321){const _0x15e8d9=a64_0x2a1369;try{const _0xee3a97=this.#cache[_0x15e8d9(0x1bd)](_0x3c9321);if(_0xee3a97?.[_0x15e8d9(0x1dd)])return _0xee3a97['action'];await this[_0x15e8d9(0x1c8)];const _0x55a756=await this.#db['findByPk'](_0x3c9321);if(_0x55a756){const _0x568a0d=_0x55a756[_0x15e8d9(0x1bd)]({'plain':!![]});return this.#cache['set'](_0x3c9321,{...this.#cache['get'](_0x3c9321)||{},'action':_0x568a0d[_0x15e8d9(0x1dd)]}),_0x568a0d['action'];}return this.#defaultAction;}catch(_0x386b18){console[_0x15e8d9(0x1e0)](_0x15e8d9(0x1d7)+_0x3c9321+':',_0x386b18);throw _0x386b18;}}['generateCmd'](_0xd4e74c){const _0x2184c2=a64_0x2a1369,_0x41fba3={'gEJsN':_0x2184c2(0x1cc),'RGXls':function(_0x241255,_0x1178b0){return _0x241255(_0x1178b0);},'SLABK':function(_0x407ec8,_0x4ce2e9){return _0x407ec8==_0x4ce2e9;},'EWBsJ':function(_0x4f1460,_0x5d9b2f){return _0x4f1460(_0x5d9b2f);},'VfRRh':function(_0x412229,_0x4d3d06){return _0x412229==_0x4d3d06;},'mKxKC':function(_0x3a5b69,_0x507f15){return _0x3a5b69(_0x507f15);},'zajGP':function(_0x20beee,_0x199b94){return _0x20beee(_0x199b94);},'JJcAb':function(_0x112ea0,_0x1659d3){return _0x112ea0===_0x1659d3;},'zteQR':_0x2184c2(0x1fe),'XeMwV':function(_0x58e0a7,_0x5a3788){return _0x58e0a7(_0x5a3788);}},{nomCom:_0x2988c7}=_0xd4e74c;zokou({..._0xd4e74c},async(_0x17865f,_0x41c946,_0x15808f)=>{const _0x52ca83=_0x2184c2,{verifGroupe:_0x748339,verifAdmin:_0x20333d,ms:_0x947fc5,arg:_0x315114,superUser:_0x2084b4,repondre:_0x14a399}=_0x15808f;if(!_0x748339)return'yhoWL'===_0x41fba3['gEJsN']?_0x31229c(_0x5a5fcc+_0x52ca83(0x1e7)):_0x14a399(_0x52ca83(0x1eb));if(!_0x2084b4&&!_0x20333d)return _0x41fba3['RGXls'](_0x14a399,'Vous\x20n\x27avez\x20pas\x20les\x20permissions\x20necessaires');try{const _0x363520='\x0aðŸ› ï¸\x20*Configuration\x20de\x20'+_0x2988c7+'*\x0a\x0aâ€¢\x20*'+_0x2988c7+'\x20'+this[_0x52ca83(0x1fa)]['enabled']+'*\x20âž¡ï¸\x20_pour\x20activer\x20la\x20fonction_\x20âœ…\x0aâ€¢\x20*'+_0x2988c7+'\x20'+this[_0x52ca83(0x1fa)][_0x52ca83(0x1ba)]+_0x52ca83(0x1d1)+_0x2988c7+_0x52ca83(0x1c6)+this['ACTIONS']['remove']+_0x52ca83(0x1bb)+_0x2988c7+_0x52ca83(0x1c6)+this['ACTIONS'][_0x52ca83(0x1c3)]+_0x52ca83(0x1ca)+_0x2988c7+_0x52ca83(0x1c6)+this[_0x52ca83(0x1fc)][_0x52ca83(0x1bc)]+'*\x20âž¡ï¸\x20_Action\x20:_\x20ðŸ””\x20Avertir';if(!_0x315114||!_0x315114[0x0]||_0x315114['join']('')[_0x52ca83(0x1fb)]()=='')return _0x14a399(_0x363520);const _0x12e448=_0x315114[0x0]['toLowerCase']();if(_0x41fba3[_0x52ca83(0x1be)](_0x12e448,this['STATES'][_0x52ca83(0x1ef)])){if(await this[_0x52ca83(0x1de)](_0x17865f))return _0x41fba3['EWBsJ'](_0x14a399,_0x2988c7+_0x52ca83(0x1c5));return await this.#addOrUpdateJid(_0x17865f,_0x12e448),_0x14a399(_0x2988c7+'\x20est\x20maintenant\x20actif');}else{if(_0x41fba3[_0x52ca83(0x1e2)](_0x12e448,this['STATES'][_0x52ca83(0x1ba)])){if(!await this[_0x52ca83(0x1de)](_0x17865f))return _0x41fba3['mKxKC'](_0x14a399,_0x2988c7+_0x52ca83(0x1e7));return await this.#addOrUpdateJid(_0x17865f,_0x12e448),_0x14a399(_0x2988c7+'\x20est\x20maintenant\x20desactive');}else{if(_0x12e448[_0x52ca83(0x1c4)]('action/')){const _0x1eb35a=_0x12e448['split']('/')[0x1]['trim']()['toLowerCase']();if(!Object['values'](this[_0x52ca83(0x1fc)])[_0x52ca83(0x1e9)](_0x1eb35a))return _0x41fba3['zajGP'](_0x14a399,'L\x27action\x20'+_0x1eb35a+'\x20n\x27est\x20pas\x20valide.\x20Les\x20actions\x20valides\x20sont:\x20'+Object[_0x52ca83(0x1f3)](this['ACTIONS'])['join'](',\x20'));return await this.#updateJidAction(_0x17865f,_0x1eb35a),_0x41fba3['mKxKC'](_0x14a399,_0x52ca83(0x1c9)+_0x2988c7+'\x20est\x20maintenant\x20'+_0x1eb35a);}else{if(_0x41fba3['JJcAb'](_0x41fba3[_0x52ca83(0x1df)],_0x52ca83(0x1fe)))return _0x14a399(_0x363520);else{const _0x22caec=_0x1765bf[_0x52ca83(0x1ee)](_0x10480d,arguments);return _0xad83c7=null,_0x22caec;}}}}}catch(_0x220b17){return console['log'](_0x52ca83(0x1d3)+_0x2988c7+_0x52ca83(0x1f7)+_0x17865f+':\x20'+_0x220b17),_0x41fba3[_0x52ca83(0x1f5)](_0x14a399,_0x52ca83(0x1da));}});}}function a64_0x3e2d(_0x370755,_0x3c957f){const _0x157c2e=a64_0x1e90();return a64_0x3e2d=function(_0x375cb9,_0x186d7b){_0x375cb9=_0x375cb9-0x1ba;let _0x1e9035=_0x157c2e[_0x375cb9];if(a64_0x3e2d['DLwvMi']===undefined){var _0x3e2d69=function(_0x2e22cb){const _0x498c42='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x2dfb03='',_0x585acf='',_0x15eddb=_0x2dfb03+_0x3e2d69;for(let _0x395a77=0x0,_0xc715a2,_0x2ecb05,_0x472a51=0x0;_0x2ecb05=_0x2e22cb['charAt'](_0x472a51++);~_0x2ecb05&&(_0xc715a2=_0x395a77%0x4?_0xc715a2*0x40+_0x2ecb05:_0x2ecb05,_0x395a77++%0x4)?_0x2dfb03+=_0x15eddb['charCodeAt'](_0x472a51+0xa)-0xa!==0x0?String['fromCharCode'](0xff&_0xc715a2>>(-0x2*_0x395a77&0x6)):_0x395a77:0x0){_0x2ecb05=_0x498c42['indexOf'](_0x2ecb05);}for(let _0x519f88=0x0,_0x1be606=_0x2dfb03['length'];_0x519f88<_0x1be606;_0x519f88++){_0x585acf+='%'+('00'+_0x2dfb03['charCodeAt'](_0x519f88)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x585acf);};a64_0x3e2d['vYdCxM']=_0x3e2d69,_0x370755=arguments,a64_0x3e2d['DLwvMi']=!![];}const _0x4975af=_0x157c2e[0x0],_0x135416=_0x375cb9+_0x4975af,_0x439f84=_0x370755[_0x135416];if(!_0x439f84){const _0x4f2419=function(_0x371201){this['psVfon']=_0x371201,this['wuujAG']=[0x1,0x0,0x0],this['YKDXpf']=function(){return'newState';},this['LhExfv']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['YDaiOp']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x4f2419['prototype']['zvmlWB']=function(){const _0x4b8eb8=new RegExp(this['LhExfv']+this['YDaiOp']),_0x1b2d0f=_0x4b8eb8['test'](this['YKDXpf']['toString']())?--this['wuujAG'][0x1]:--this['wuujAG'][0x0];return this['cWwtoP'](_0x1b2d0f);},_0x4f2419['prototype']['cWwtoP']=function(_0x2fac92){if(!Boolean(~_0x2fac92))return _0x2fac92;return this['ripreM'](this['psVfon']);},_0x4f2419['prototype']['ripreM']=function(_0x584ca0){for(let _0x3d8044=0x0,_0x38ab21=this['wuujAG']['length'];_0x3d8044<_0x38ab21;_0x3d8044++){this['wuujAG']['push'](Math['round'](Math['random']())),_0x38ab21=this['wuujAG']['length'];}return _0x584ca0(this['wuujAG'][0x0]);},new _0x4f2419(a64_0x3e2d)['zvmlWB'](),_0x1e9035=a64_0x3e2d['vYdCxM'](_0x1e9035),_0x370755[_0x135416]=_0x1e9035;}else _0x1e9035=_0x439f84;return _0x1e9035;},a64_0x3e2d(_0x370755,_0x3c957f);}module['exports']=EventStateManager;